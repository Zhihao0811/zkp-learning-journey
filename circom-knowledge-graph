               ┌──────────────────────────────────────────┐
               │                 Circom                   │
               │    (A DSL for constructing ZK circuits)  │
               └──────────────────────────────────────────┘
                                  │
        ┌─────────────────────────┼─────────────────────────┐
        │                         │                         │
        ▼                         ▼                         ▼
┌────────────────┐      ┌────────────────────┐    ┌───────────────────────┐
│ Circom Language│      │ Circuit Structure  │    │   Cryptographic Base  │
└────────────────┘      └────────────────────┘    └───────────────────────┘
        │                         │                         │
        │                         │                         │
        ▼                         ▼                         ▼
┌───────────────┐       ┌──────────────────┐       ┌────────────────────┐
│ Syntax & Types│       │ Templates & Mods │       │ Field Arithmetic   │
│ - signals     │       │ - template       │       │ - prime fields     │
│ - inputs/outs │       │ - components     │       │ - mod arithmetic   │
│ - arrays      │       │ - parameters     │       │ - EC ops intro     │
└───────────────┘       └──────────────────┘       └────────────────────┘
        │                         │                         │
        ▼                         ▼                         ▼
┌───────────────┐       ┌──────────────────┐       ┌────────────────────────┐
│  Constraints  │       │  Composition     │       │  Hash & Merkle         │
│ - polynomial  │       │ - loops          │       │ - Poseidon / MiMC      │
│ - linear eqns │       │ - arrays         │       │ - Merkle tree logic    │
│ - R1CS logic  │       │ - modular design │       │ - Signature circuits   │
└───────────────┘       └──────────────────┘       └────────────────────────┘
        │                         │                         │
        └───────────────┬─────────┴───────────────┬─────────┘
                        ▼                         ▼
           ┌─────────────────────┐       ┌───────────────────────┐
           │   Circom Compiler   │       │  Standard Libraries   │
           │   (circom → R1CS)   │       │      circomlib        │
           └─────────────────────┘       └───────────────────────┘
                        │                         │
                        ▼                         ▼
       ┌──────────────────────────────────────────────────────┐
       │                 Witness Generation                   │
       │   (generate_witness.js / wasm / snarkjs witness)     │
       └──────────────────────────────────────────────────────┘
                        │
                        ▼
       ┌──────────────────────────────────────────────────────┐
       │                     R1CS System                      │
       │         (Rank-1 Constraint System matrices)          │
       │      A, B, C matrices → sparse structure → FEM       │
       └──────────────────────────────────────────────────────┘
                        │
                        ▼
       ┌──────────────────────────────────────────────────────┐
       │                Proving Pipeline                      │
       │             (via snarkjs / Groth16)                  │
       │  - setup: CRS                                        │
       │  - proving key & verification key                    │
       │  - generate proof                                    │
       │  - verify proof                                      │
       └──────────────────────────────────────────────────────┘
                        │
                        ▼
       ┌──────────────────────────────────────────────────────┐
       │           On-chain / Off-chain Integration           │
       │  - Solidity verifier                                 │
       │  - circuit inputs on-chain                           │
       │  - proof verification                                │
       └──────────────────────────────────────────────────────┘



                               ┌─────────────────────────┐
                               │        Circom DSL       │
                               │ Signals / Templates /   │
                               │ Constraints / Loops     │
                               └─────────────┬───────────┘
                                             │ Signals / Templates / Loops
                                             ▼
                               ┌─────────────────────────┐
                               │       Compiler          │
                               │  .circom → .r1cs        │
                               │  Constraint Flattening  │
                               │  WASM Gen for Witness   │
                               └─────────────┬───────────┘
                                             │ Emits
                                             ▼
                               ┌─────────────────────────┐
                               │    Witness Generation   │
                               │ Map Private Inputs      │
                               │ Evaluate Signals &      │
                               │ Constraints             │
                               │ Output: witness.json    │
                               └───────┬─────────┬───────┘
                                       │         │
                 ┌─────────────────────┘         └─────────────────────┐
                 ▼                                               ▼
        ┌───────────────────┐                            ┌───────────────────┐
        │ Multi-thread CPU  │                            │ GPU / CUDA Kernels│
        │ Signal Eval / FFT │                            │ FFT / MSM / Poly  │
        └─────────┬─────────┘                            └─────────┬─────────┘
                  │                                                │
                  └──── Backflow Optimization ────┬────────────────┘
                                                  ▼
                               ┌─────────────────────────┐
                               │        R1CS Layer       │
                               │ Sparse Matrices: A/B/C  │
                               │ Field Ops / Constraint  │
                               │ Optimization / Folding  │
                               └─────────────┬───────────┘
                                             │ R1CS + witness → Prover
                                             ▼
                               ┌─────────────────────────┐
                               │       Prover Pipeline    │
                               │ CRS / Trusted Setup      │
                               │ Proving Key / Verif Key  │
                               │ Generate Proof           │
                               │ Verify Proof             │
                               └───────┬─────────┬────────┘
                                       │         │
                 ┌─────────────────────┘         └─────────────────────┐
                 ▼                                               ▼
        ┌──────────────────┐                             ┌──────────────────┐
        │ Multi-thread CPU │                             │ GPU / FFT / MSM  │
        │ Proof Generation │                             │ Polynomial Ops   │
        └─────────┬────────┘                             └─────────┬────────┘
                  │                                                │
                  └─── Backflow Optimization ─────┬────────────────┘
                                                  ▼
                                               [Proof]

          ┌─────────────────────────────┐                        ┌─────────────────────────────────┐
          │ Performance Optimization    │                        │ Cryptography Components         │
          │ - CPU / GPU Parallelism     │                        │ - Finite Fields / EC Ops        │
          │ - Memory / Cache Layout     │                        │ - Hash Functions Poseidon/MiMC  │
          │ - Constraint Folding / Reuse│                        │ - Merkle Tree / Signature       │
          └───────┬─────────────────────┘                        └─────────────┬───────────────────┘
                  │                                                            │
                  └──────── Feedback Loop (supports R1CS & Prover) ────────────┘
                        (Accelerates Witness & Prover, Supports R1CS)


